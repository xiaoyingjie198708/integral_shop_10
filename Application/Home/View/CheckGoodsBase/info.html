<link rel="stylesheet" href="__PUBLIC__/css/uniform.css" />
<script type="text/javascript" src="__PUBLIC__/js/jquery.uniform.js"></script>
<style>
    .form-horizontal .controls{*display:block-inline;}
    .controls > .radio:first-child, .controls > .checkbox:first-child{padding-top:0;}
    .controls label{display:inline-block; height:20px; padding:4px 10px 4px 0;margin-bottom:0;}
    .form-horizontal .control-label{padding-top:10px;}
    
    .special_box{ width:98%; overflow:hidden;border:1px solid #cdcdcd;}
    #add_special_box{margin-top:10px;}
    .special_box .control-label{width:150px;}
    .special_box .controls{margin-left:150px;}
    .special_box .control-group{overflow:hidden;}
    .special_box .form-actions{padding-left:160px;}
    .special_box .special_info{padding:10px 20px;float:left;}
    .special_box .del{padding:10px 0 10px 30px;float:left;}
    .special_box .update{padding:10px;float:left;}
    #special_list .control-group:hover,#special_list div.active{background-color:#eaeaea;}
    
    .img_box{margin:15px 0; overflow:hidden;}
    .img_box ul{list-style:none; margin:0;}
    .img_box ul li{float:left; width:140px; height:140px;cursor:pointer;margin-right:15px;margin-bottom:10px;}
    .img_box ul li:hover{border-color:#08c; box-shadow:0 1px 4px rgba(0,105, 214,0.25);}
    .img_box ul li.active{border-color:red; box-shadow:0 1px 4px rgba(0,105, 214,0.25);}
    
    .tab-left{border:1px solid #ddd; overflow:hidden;background-color:#fff;width:99%;}
    .tab-left .nav{float:left;}
    .tab-left .nav li{float:none;border-bottom:1px solid #ddd;border-right:1px solid #ddd;height:40px;line-height:40px;padding:0 8px;text-align:center;font-weight:bold;background-color:#f9f9f9;}
    .tab-left .nav li.active{border-right:none;background-color:#fff;color:#444;}
    .tab-left .nav li a{background-color:#f9f9f9;color:#999;}
    .tab-left .nav li.active a{color:#444;background-color:#fff;}
    .tab-left .tab-content{border:none;}
    .conf_data_list{list-style:none;padding-left:20px;}
    .conf_data_list li{border-bottom:1px solid #ddd;margin-bottom:10px;padding-bottom:10px;}
    .conf_data_list li label{display:inline-block;height:auto;}
    .conf_data_list li:last-child{border-bottom:none;}
</style>
<div class="container-fluid">
    <div class="widget-box">
        <div class="widget-title add_box">
            <ul class="nav nav-tabs">
                <volist name="goods_label" id="label" key="label_i">
                <li class="{:set_class(1,$label_i,'active')}"><a data-toggle="tab" href="#tab_{$label_i}">{$label}</a></li>
                </volist>
            </ul>
            <a class="btn btn-success btn-mini" href="{:back_list_url()}"><i class="icon-share-alt icon-white"></i> 返回列表</a>
        </div>
        <div class="widget-content" style="padding:0;margin-top:12px;border-top:1px solid #eee;">
            <form id="edit_goods_form" class="form-horizontal tab-content" method="post" autocomplete="off" />
                <div class="tab-pane active" id="tab_1" data-step="1">
                    <div class="control-group">
                        <label class="control-label">商品分类：</label>
                        <div class="controls">{$info.category_name}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">商铺名称：</label>
                        <div class="controls">{$info.shops_name}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">商品名称：</label>
                        <div class="controls">{$info.goods_name}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">物料编码：</label>
                        <div class="controls">{$info.goods_materiel_code|default="无"}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">商品品牌：</label>
                        <div class="controls">{$info.brand_name}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">单位：</label>
                        <div class="controls">{$info.goods_unit|id2name='goods_unit',###}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">商品简介：</label>
                        <div class="controls">{$info.goods_brief|nl2br}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">搜索关键字：</label>
                        <div class="controls">{$info.search_key_word}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">商品排序：</label>
                        <div class="controls">{$info.goods_sort}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">支持邮寄：</label>
                        <div class="controls">{$info['is_object'] == 1 ? '支持' : '不支持'}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">前台搜索：</label>
                        <div class="controls">{$info['is_search'] == 1 ? '可搜索' : '不可搜索'}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">验证库存：</label>
                        <div class="controls">{$info['is_check_store'] == 1 ? '支持' : '不支持'}</div>
                    </div>
                     <div class="control-group">
                        <label class="control-label">退货：</label>
                        <div class="controls">{$info['is_promotion'] == 1 ? '支持' : '不支持'}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">换货：</label>
                        <div class="controls">{$info['is_change'] == 1 ? '支持' : '不支持'}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">预约服务：</label>
                        <div class="controls">{$info['service_type'] == 1 ? '预约产品' : '非预约产品'}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">黑名单能否购买：</label>
                        <div class="controls">{$info['is_black'] == 1 ? '能' : '不能'}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">商品类型：</label>
                        <div class="controls">{$info.goods_type|id2name='goods_type',###}</div>
                    </div>
                    <div class="control-group {$info['goods_type'] == 2 ? '' : 'hide'}" id="lp_box">
                        <label class="control-label">添加礼包商品：</label>
                        <div class="controls">
                             <table class="table table-bordered table-center" style="margin-top: 10px;">
                                <thead>
                                    <tr>
                                        <th>商品编码</th>
                                        <th>物料编码</th>
                                        <th>商品名称</th>
                                        <th>商家名称</th>
                                        <th>销售价</th>
                                        <th>积分</th>
                                    </tr>
                                </thead>
                                <tbody id="main_goods_box">
                                    <volist name="goods_list" id="goods_info">
                                        <tr>
                                            <td>{$goods_info.goods_code}<input type="hidden" name="relation_good_ids[]" value="{$goods_info.goods_id}"/></td>
                                            <td>{$goods_info.goods_materiel_code}</td>
                                            <td>{$goods_info.goods_name}</td>
                                            <td>{$goods_info.shops_name}</td>
                                            <td>{$goods_info.goods_price}</td>
                                            <td>{$goods_info.max_integral}</td>
                                        </tr>
                                    </volist>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">服务产品：</label>
                        <div class="controls">{$info['service_type'] == 1 ? '是' : '非服务产品'}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">商品图片：</label>
                        <div class="controls">
                            <div class="img_box">
                                <ul class="img_ul">
                                    <volist name="goods_img_list" id="img">
                                        <li data-path="{$img}" class="thumbnail">
                                            <img src="">
                                        </li>
                                    </volist>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">橱窗图片：</label>
                        <div class="controls">
                            <div class="img_box">
                                <ul class="img_ul">
                                    <volist name="win_img_list" id="img">
                                        <li data-path="{$img}" class="thumbnail">
                                            <img src="">
                                        </li>
                                    </volist>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="control-group hide">
                        <label class="control-label">商品规格：</label>
                        <div class="controls">
                            <empty name="spec_list">
                                暂时没有商品规格
                            </empty>
                            <div id="specofocationBox">
                                <foreach name="spec_list" item="spec">
                                    <div style='margin:10px 0px;'>
                                        <label>{$spec.spec_name}</label>
                                        <span class='value_box'>值：{$spec.spec_value}</span>
                                    </div>
                                </foreach>
                            </div>
                        </div>
                    </div>
                    <div class="control-group hide">
                        <label class="control-label">商品配置：</label>
                        <div class="controls">
                            <div class="widget-box tab-left" style="margin-top:0;width: 80%;">
                                <ul class="nav">
                                    <volist name="goods_conf_list" id="conf1" key="conf1_i">
                                    <li class="{:set_class(1,$conf1_i,'active')}">
                                        <a data-toggle="tab" href="#tab_conf_{$conf1.param_category_id}">{$conf1.category_name}</a>
                                    </li>
                                    </volist>
                                </ul>
                                <div class="widget-content tab-content">
                                    <volist name="goods_conf_list" id="conf1" key="conf1_i">
                                    <div id="tab_conf_{$conf1.param_category_id}" class="tab-pane {:set_class(1,$conf1_i,'active')}">
                                        <ul class="conf_data_list" style="margin:0;text-align:left;">
                                        <volist name="conf1.child" id="conf2" empty="暂无内容">
                                            <li>
                                                <b>{$conf2.param_name}：</b>
                                                <span>
                                                    <volist name="conf2.child" id="conf3">
                                                        <if condition="$conf3['selected']">
                                                            <label>{$conf3.param_value}</label>
                                                        </if>
                                                    </volist>
                                                </span>
                                            </li>
                                        </volist>
                                        </ul>
                                    </div>
                                    </volist>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane" id="tab_2"  data-step="2">
                    <div class="control-group">
                        <label class="control-label">商品特性：</label>
                        <div class="controls">
                            <div class="special_box {:set_class(null,$special_list,'hide')}" id="special_list">
                                <empty name="special_list">
                                    暂时没有特性信息
                                </empty>
                                <volist name="special_list" id="special">
                                    <div class="control-group" data-data="{$special|json_encode|base64_encode}">
                                        <div class="special_info">{$special.special_name}</div>
                                        <a href="javascript:;" class="update">查看</a>
                                    </div>
                                </volist>
                            </div>
                            <div class="special_box hide" id="add_special_box">
                                <div class="control-group">
                                    <label class="control-label">特性名称：</label>
                                    <div class="controls" id="special_name"></div>
                                </div>
                                <div class="control-group">
                                    <label class="control-label">特性平台：</label>
                                    <div class="controls" id="special_platform">
                                        <foreach name="Think.config.special_platform" item="platform" key="platform_i">
                                        <label><input type="radio" name="special_platform" value="{$platform_i}" {:set_class(1,$platform_i,'checked')} />{$platform} </label>
                                        </foreach>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label class="control-label">特性排序：</label>
                                    <div class="controls" id="special_sort"></div>
                                </div>
                                <div class="control-group">
                                    <label class="control-label">特性内容：</label>
                                    <div class="controls" id="special_content"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            <div class="tab-pane" id="tab_3"  data-step="3">
                    <if condition="$info['pre_up_time']">
                        <div class="control-group">
                            <label class="control-label">预约上架时间：</label>
                            <div class="controls">{$info.pre_up_time}</div>
                        </div>
                    </if>
                    <if condition="$info['expect_down_time']">
                        <div class="control-group">
                            <label class="control-label">预约下架时间：</label>
                            <div class="controls">{$info.expect_down_time}</div>
                        </div>
                    </if>
                    <if condition="$info['timeout_time']">
                         <div class="control-group">
                            <label class="control-label">（消费码）过期时间：</label>
                            <div class="controls">
                                {$info.timeout_time}
                                <span class="help-block">如果填写过期时间，则生成的消费码过期时间为此时间。</span>
                            </div>
                        </div>
                    </if>
                    <if condition="$stock_info['stock_id']">
                        <div class="control-group">
                            <label class="control-label">当前库存：</label>
                            <div class="controls">
                                {$stock_info.total_stocks}
                            </div>
                        </div>        
                    </if>
                    <div class="control-group">
                        <label class="control-label">限制兑换次数：</label>
                        <div class="controls">
                            {$info['year_count']}
                            <span class="help-block">默认不限制，商品一个人限制时间内购买的数量，-1表示不限制，大于-1表示只能购买的数量</span>
                        </div>
                    </div>
                    <if condition="$info['year_count'] gt -1">
                        <div class="control-group">
                            <label class="control-label">限制时间：</label>
                            <div class="controls">{$info.limit_start_time} ~ {$info.limit_end_time}</div>
                        </div>
                    </if>
                    <div class="control-group">
                        <label class="control-label">总兑换次数：</label>
                        <div class="controls">
                            {$info['total_count']}
                            <span class="help-block">商品一个人总购买的数量，-1表示不限制，大于-1表示只能购买的数量</span>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">市场价：</label>
                        <div class="controls">{$info.goods_media_price|price_format}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">结算价：</label>
                        <div class="controls">{$info.goods_cost_price|price_format}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">是否固定积分：</label>
                        <div class="controls">{$info['integral'] == '0' ? '否' : '是'}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">{$info['integral'] == '1' ? '销售价' : '总销售价'}：</label>
                        <div class="controls">{$info.goods_price_pc|price_format}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">{$info['integral'] == '1' ? '固定积分数' : '最大积分抵扣金额'}（元）：</label>
                        <div class="controls">
                            {$info.max_integral}
                            <div class="help-block">0标识只能用钱购买，不能使用积分，积分兑换比例{$Think.config.INTEGRAL_RATE.point}:{$Think.config.INTEGRAL_RATE.rmb}</div>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">可使用储值卡：</label>
                        <div class="controls">{$info['use_storage_money']|id2name='use_storage_money',###}</div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">促销语：</label>
                        <div class="controls">
                            {$info.promotion_content_pc|default='无'}
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">销售类型：</label>
                        <div class="controls">
                            {$info.sale_type|id2name='sale_type',###}
                        </div>
                    </div>
                    <div class="control-group {:set_class(2,$info['sale_type'],'hide','!=')}">
                        <label class="control-label">上市时间：</label>
                        <div class="controls">
                            {$info.expect_up_time}
                        </div>
                    </div>
                </div>
                <div class="tab-pane" id="tab_4"  data-step="4">
                    <div class="control-group">
                        <label class="control-label">标签信息：</label>
                        <div class="controls">
                            <volist name="checked_label_list" id="conf" key="conf_i" empty="暂无标签信息">
                            <div class="control-group" {$conf_i == 1 ? 'style="border-top:none;"' : ''}>
                                <div class="controls" style="margin-left:0;">
                                    {$conf.parent_name} ： {$conf.label_name}
                                </div>
                            </div>
                            </volist>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<script type="text/javascript">
    $('input[type=radio]').uniform(); //美化checkbox，radio按钮
    /*---------------------------------------------------------------图片信息-------------------------------------------------*/
    var _show_img = true;
    var _source = "{$info.source}";
    if(_show_img){
        $('.img_ul li').each(function() { 
            if(_source == 1){
                $(this).find('img').attr('src',createImageUrl($(this).data('path'),'140_140'));
            }else{
                $(this).find('img').attr('src',$(this).data('path'));
            }
            image_center($(this));
        });
        _show_img = false;
    }
    /*---------------------------------------------------------------特性信息-------------------------------------------------*/
    $('#special_list .control-group').each(function() {
        $(this).data('data',$.parseJSON(base64_decode($(this).data('data'))));
    });
    $('#special_list').find('.update').live('click',function() {
        var _this = $(this);
        $('#add_special_box').slideUp(600,function() {
            $('#special_list .control-group').removeClass('active');
            _this.parent().addClass('active');
            var _data = _this.parent().data('data');
            $("input[name=special_platform]").each(function(){
                var _this = $(this);
                if(_this.val() == 1){
                    _this.data('content',_data.special_content_pc);
                }else{
                    _this.data('content',_data.special_content_mobile);
                }
            });
            $('#special_name').html(_data.special_name);
            $('#special_content').html(_data.special_content_pc);
            $("#special_sort").html(_data.special_sort);
            $('#add_special_box').slideDown(600);
        });        
    });
    //切换编辑器
    $("input[name=special_platform]").change(function(){
        var _this = $(this);
        var _content = _this.data('content');
        if(!_content) _content = '';
        $('#special_content').html(_content);
    });
</script>